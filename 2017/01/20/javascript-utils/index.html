<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>项目中用过的那些javascript工具函数 | Kenve's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">项目中用过的那些javascript工具函数</h1><a id="logo" href="/.">Kenve's Blog</a><p class="description">世界和平(.)</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">项目中用过的那些javascript工具函数</h1><div class="post-meta">Jan 20, 2017<span> | </span><span class="category"><a href="/categories/Web/">Web</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><h4 id="时间戳转换为YY-MM-DD-hh-mm-ss-字符串格式"><a href="#时间戳转换为YY-MM-DD-hh-mm-ss-字符串格式" class="headerlink" title="时间戳转换为YY-MM-DD hh:mm:ss 字符串格式"></a>时间戳转换为YY-MM-DD hh:mm:ss 字符串格式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">timeFormat(timestamp) &#123;</div><div class="line">    <span class="comment">//timestamp是整数，否则要parseInt转换</span></div><div class="line">    <span class="keyword">var</span> time = <span class="keyword">new</span> <span class="built_in">Date</span>(timestamp);</div><div class="line">    <span class="keyword">var</span> y = time.getFullYear();</div><div class="line">    <span class="keyword">var</span> m = time.getMonth() + <span class="number">1</span>;</div><div class="line">    <span class="keyword">var</span> d = time.getDate();</div><div class="line">    <span class="keyword">var</span> h = time.getHours();</div><div class="line">    <span class="keyword">var</span> mm = time.getMinutes();</div><div class="line">    <span class="keyword">var</span> s = time.getSeconds();</div><div class="line">    <span class="keyword">return</span> y + <span class="string">'-'</span> + add02Time(m) + <span class="string">'-'</span> + add02Time(d) + <span class="string">' '</span> +add02Time(h) + <span class="string">':'</span> +add02Time(mm) + <span class="string">':'</span> + add02Time(s);</div><div class="line">&#125;;</div><div class="line">add02Time(m) &#123;</div><div class="line">    <span class="keyword">return</span> m &lt; <span class="number">10</span> ? <span class="string">'0'</span> + m : m</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h4 id="把对象中的属性拼接到URL参数中（url-a-x-amp-b-y）"><a href="#把对象中的属性拼接到URL参数中（url-a-x-amp-b-y）" class="headerlink" title="把对象中的属性拼接到URL参数中（url?a=x&amp;b=y）"></a>把对象中的属性拼接到URL参数中（url?a=x&amp;b=y）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">joinParamsInGetReq(url, param) &#123;</div><div class="line">    <span class="keyword">if</span> (param) &#123;</div><div class="line">        <span class="keyword">let</span> paramsArray = []</div><div class="line">        <span class="built_in">Object</span>.keys(param).forEach(<span class="function"><span class="params">key</span> =&gt;</span> paramsArray.push(key + <span class="string">'='</span> + <span class="built_in">encodeURIComponent</span>(param[key])))</div><div class="line">        <span class="keyword">if</span> (url.search(<span class="regexp">/\?/</span>) === <span class="number">-1</span>) &#123;</div><div class="line">            url += <span class="string">'?'</span> + paramsArray.join(<span class="string">'&amp;'</span>)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            url += <span class="string">'&amp;'</span> + paramsArray.join(<span class="string">'&amp;'</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> url;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h4 id="对象或数组的深拷贝"><a href="#对象或数组的深拷贝" class="headerlink" title="对象或数组的深拷贝"></a>对象或数组的深拷贝</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">deepCopyObj(obj) &#123;</div><div class="line">    <span class="keyword">var</span> str, newobj = obj.constructor === <span class="built_in">Array</span> ? [] : &#123;&#125;;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">'object'</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.JSON) &#123;</div><div class="line">        str = <span class="built_in">JSON</span>.stringify(obj), <span class="comment">//系列化对象</span></div><div class="line">            newobj = <span class="built_in">JSON</span>.parse(str); <span class="comment">//还原</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</div><div class="line">            newobj[i] = <span class="keyword">typeof</span> obj[i] === <span class="string">'object'</span> ? <span class="keyword">this</span>.deepCopyObj(obj[i]) : obj[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newobj;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h4 id="判断浏览器类型"><a href="#判断浏览器类型" class="headerlink" title="判断浏览器类型"></a>判断浏览器类型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * 智能机浏览器版本信息:</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="keyword">var</span> browser = &#123;</div><div class="line">        <span class="attr">versions</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> u = navigator.userAgent,</div><div class="line">                app = navigator.appVersion;</div><div class="line">            <span class="keyword">return</span> &#123; <span class="comment">//移动终端浏览器版本信息 </span></div><div class="line">                trident: u.indexOf(<span class="string">'Trident'</span>) &gt; <span class="number">-1</span>, <span class="comment">//IE内核</span></div><div class="line">                presto: u.indexOf(<span class="string">'Presto'</span>) &gt; <span class="number">-1</span>, <span class="comment">//opera内核</span></div><div class="line">                webKit: u.indexOf(<span class="string">'AppleWebKit'</span>) &gt; <span class="number">-1</span>, <span class="comment">//苹果、谷歌内核</span></div><div class="line">                gecko: u.indexOf(<span class="string">'Gecko'</span>) &gt; <span class="number">-1</span> &amp;&amp; u.indexOf(<span class="string">'KHTML'</span>) == <span class="number">-1</span>, <span class="comment">//火狐内核</span></div><div class="line">                mobile: !!u.match(<span class="regexp">/AppleWebKit.*Mobile.*/</span>) || !!u.match(<span class="regexp">/AppleWebKit/</span>), <span class="comment">//是否为移动终端</span></div><div class="line">                ios: !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>), <span class="comment">//ios终端</span></div><div class="line">                android: u.indexOf(<span class="string">'Android'</span>) &gt; <span class="number">-1</span> || u.indexOf(<span class="string">'Linux'</span>) &gt; <span class="number">-1</span>, <span class="comment">//android终端或者uc浏览器</span></div><div class="line">                iPhone: u.indexOf(<span class="string">'iPhone'</span>) &gt; <span class="number">-1</span> || u.indexOf(<span class="string">'Mac'</span>) &gt; <span class="number">-1</span>, <span class="comment">//是否为iPhone或者QQHD浏览器</span></div><div class="line">                iPad: u.indexOf(<span class="string">'iPad'</span>) &gt; <span class="number">-1</span>, <span class="comment">//是否iPad</span></div><div class="line">                webApp: u.indexOf(<span class="string">'Safari'</span>) == <span class="number">-1</span>, <span class="comment">//是否web应该程序，没有头部与底部</span></div><div class="line">                wechat: u.toLowerCase().match(<span class="regexp">/MicroMessenger/i</span>) == <span class="string">"micromessenger"</span> <span class="comment">//判断是否为微信浏览器</span></div><div class="line">            &#125;;</div><div class="line">        &#125;(),</div><div class="line">        <span class="attr">language</span>: (navigator.browserLanguage || navigator.language).toLowerCase() <span class="comment">//语言版本</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取cookie</div><div class="line">     * @param  &#123;[type]&#125; c_name [cookie名称]</div><div class="line">     * @return &#123;[type]&#125;        [cookie的value]</div><div class="line">     */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">c_name</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.cookie.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        c_start = <span class="built_in">document</span>.cookie.indexOf(c_name + <span class="string">"="</span>);</div><div class="line">        <span class="keyword">if</span> (c_start != <span class="number">-1</span>) &#123;</div><div class="line">            c_start = c_start + c_name.length + <span class="number">1</span>;</div><div class="line">            c_end = <span class="built_in">document</span>.cookie.indexOf(<span class="string">";"</span>, c_start);</div><div class="line">            <span class="keyword">if</span> (c_end == <span class="number">-1</span>) c_end = <span class="built_in">document</span>.cookie.length;</div><div class="line">            <span class="keyword">return</span> <span class="built_in">unescape</span>(<span class="built_in">document</span>.cookie.substring(c_start, c_end));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 设置cookie的值和日期</div><div class="line"> * @param &#123;[type]&#125; c_name     [cookie名称]</div><div class="line"> * @param &#123;[type]&#125; value      [cookie的值]</div><div class="line"> * @param &#123;[type]&#125; expiredays [cookie有效期]</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCookie</span>(<span class="params">c_name, value, expiredays</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> exdate = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    exdate.setDate(exdate.getDate() + expiredays);</div><div class="line">    <span class="built_in">document</span>.cookie = c_name + <span class="string">"="</span> + <span class="built_in">escape</span>(value) +</div><div class="line">        ((expiredays == <span class="literal">null</span>) ? <span class="string">""</span> : <span class="string">";expires="</span> + exdate.toGMTString());</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * [删除 cookie]</div><div class="line"> * @param  &#123;[type]&#125; name [description]</div><div class="line"> * @return &#123;[type]&#125;      [description]</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">delCookie</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> exp = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    exp.setTime(exp.getTime() - <span class="number">1</span>);</div><div class="line">    <span class="keyword">var</span> cval = getCookie(name);</div><div class="line">    <span class="keyword">if</span> (cval != <span class="literal">null</span>) <span class="built_in">document</span>.cookie = name + <span class="string">"="</span> + cval + <span class="string">";expires="</span> + exp.toGMTString();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Toast提示"><a href="#Toast提示" class="headerlink" title="Toast提示"></a>Toast提示</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">warn</span>(<span class="params">msg, opt, left, top</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (opt) &#123;</div><div class="line">        <span class="keyword">var</span> obj = $(<span class="string">"#"</span> + opt);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">new</span> Toast(&#123; <span class="attr">context</span>: $(<span class="string">'body'</span>), <span class="attr">message</span>: msg &#125;, obj, left, top).show();</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> Toast = <span class="function"><span class="keyword">function</span>(<span class="params">config, obj, left, top</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.context = config.context == <span class="literal">null</span> ? $(<span class="string">'body'</span>) : config.context; <span class="comment">//上下文</span></div><div class="line">    <span class="keyword">this</span>.message = config.message; <span class="comment">//显示内容</span></div><div class="line">    <span class="keyword">this</span>.time = config.time == <span class="literal">null</span> ? <span class="number">3000</span> : config.time; <span class="comment">//持续时间</span></div><div class="line">    <span class="keyword">this</span>.left = config.left; <span class="comment">//距容器左边的距离</span></div><div class="line">    <span class="comment">// this.top = (screen.availHeight / 4) * 2; //距容器上方的距离</span></div><div class="line">    <span class="keyword">this</span>.top = config.top;</div><div class="line">    <span class="keyword">if</span> (obj) &#123;</div><div class="line">        <span class="keyword">this</span>.left = obj.offset().left + left;</div><div class="line">        <span class="keyword">this</span>.top = obj.offset().top + top;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.init();</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> msgEntity;</div><div class="line">Toast.prototype = &#123;</div><div class="line">    <span class="comment">//初始化显示的位置内容等</span></div><div class="line">    init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        $(<span class="string">"#toastMessage"</span>).remove();</div><div class="line">        <span class="comment">//设置消息体</span></div><div class="line">        <span class="keyword">var</span> msgDIV = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">        msgDIV.push(<span class="string">'&lt;div id="toastMessage"&gt;'</span>);</div><div class="line">        msgDIV.push(<span class="string">'&lt;span&gt;'</span> + <span class="keyword">this</span>.message + <span class="string">'&lt;/span&gt;'</span>);</div><div class="line">        msgDIV.push(<span class="string">'&lt;/div&gt;'</span>);</div><div class="line">        msgEntity = $(msgDIV.join(<span class="string">''</span>)).appendTo(<span class="keyword">this</span>.context);</div><div class="line">        <span class="comment">//设置消息样式</span></div><div class="line">        <span class="keyword">var</span> left = <span class="keyword">this</span>.left == <span class="literal">null</span> ? <span class="keyword">this</span>.context.width() / <span class="number">2</span> - msgEntity.find(<span class="string">'span'</span>).width() / <span class="number">2</span> - <span class="number">20</span> : <span class="keyword">this</span>.left; <span class="comment">//padding 10+10</span></div><div class="line">        <span class="keyword">var</span> top = <span class="keyword">this</span>.top == <span class="literal">null</span> ? <span class="string">'55%'</span> : <span class="keyword">this</span>.top;</div><div class="line">        msgEntity.css(&#123; <span class="attr">position</span>: <span class="string">'fixed'</span>, <span class="attr">top</span>: top, <span class="string">'z-index'</span>: <span class="string">'99'</span>, <span class="attr">left</span>: left, <span class="string">'background'</span>: <span class="string">'#000'</span>, <span class="attr">color</span>: <span class="string">'white'</span>, <span class="string">'font-size'</span>: <span class="string">'.26rem'</span>, <span class="attr">padding</span>: <span class="string">'10px'</span>, <span class="string">'border-radius'</span>: <span class="string">'4px'</span>, <span class="string">'-moz-border-radius'</span>: <span class="string">'4px'</span>, <span class="string">'-webkit-border-radius'</span>: <span class="string">'4px'</span> &#125;);</div><div class="line">        <span class="comment">//msgEntity.addClass(".toast");</span></div><div class="line">        msgEntity.hide();</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">//显示动画</span></div><div class="line">    show: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        msgEntity.show();</div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            msgEntity.hide();</div><div class="line">        &#125;, <span class="keyword">this</span>.time / <span class="number">2</span>);</div><div class="line">        <span class="comment">// msgEntity.fadeIn(this.time / 2);</span></div><div class="line">        <span class="comment">// msgEntity.fadeOut(this.time / 2);</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="截取规定长度的字符串"><a href="#截取规定长度的字符串" class="headerlink" title="截取规定长度的字符串"></a>截取规定长度的字符串</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 截取字符串</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cutString</span>(<span class="params">str, len</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (str.length * <span class="number">2</span> &lt;= len) &#123;</div><div class="line">        <span class="keyword">return</span> str;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> strlen = <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> s = <span class="string">""</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</div><div class="line">        s = s + str.charAt(i);</div><div class="line">        <span class="keyword">if</span> (str.charCodeAt(i) &gt; <span class="number">128</span>) &#123;</div><div class="line">            strlen = strlen + <span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span> (strlen &gt;= len) &#123;</div><div class="line">                <span class="keyword">return</span> s.substring(<span class="number">0</span>, s.length - <span class="number">1</span>) + <span class="string">"..."</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            strlen = strlen + <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (strlen &gt;= len) &#123;</div><div class="line">                <span class="keyword">return</span> s.substring(<span class="number">0</span>, s.length - <span class="number">2</span>) + <span class="string">"..."</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> s;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="返回顶部"><a href="#返回顶部" class="headerlink" title="返回顶部"></a>返回顶部</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">backTop</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $(<span class="string">'html,body'</span>).scrollTop(<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkPosition</span>(<span class="params">pos</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> ($(<span class="built_in">window</span>).scrollTop() &gt; pos) &#123;</div><div class="line">        $(<span class="string">'#top'</span>).css(<span class="string">'visibility'</span>, <span class="string">'visible'</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $(<span class="string">'#top'</span>).css(<span class="string">'visibility'</span>, <span class="string">'hidden'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="根据分辨率设置html的font-size值"><a href="#根据分辨率设置html的font-size值" class="headerlink" title="根据分辨率设置html的font-size值"></a>根据分辨率设置html的font-size值</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">! <span class="function"><span class="keyword">function</span>(<span class="params">win</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> doc = win.document,</div><div class="line">        docEle = doc.documentElement,</div><div class="line">        num = <span class="number">10</span>,</div><div class="line">        changeScreenSize = <span class="string">"orientationchange"</span> <span class="keyword">in</span> win ? <span class="string">"orientationchange"</span> : <span class="string">"resize"</span>,</div><div class="line">        setFontSize = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> clientWidth = docEle.clientWidth;</div><div class="line">            docEle.style.fontSize = clientWidth / num + <span class="string">"px"</span></div><div class="line">        &#125;;</div><div class="line">    doc.addEventListener &amp;&amp; (win.addEventListener(changeScreenSize, setFontSize, !<span class="number">1</span>), doc.addEventListener(<span class="string">"DOMContentLoaded"</span>, setFontSize, !<span class="number">1</span>))</div><div class="line">&#125;(<span class="built_in">window</span>);</div></pre></td></tr></table></figure>
<h4 id="判断浏览设备竖屏或者横屏"><a href="#判断浏览设备竖屏或者横屏" class="headerlink" title="判断浏览设备竖屏或者横屏"></a>判断浏览设备竖屏或者横屏</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 判断横屏竖屏</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">window</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> supportOrientation = (<span class="keyword">typeof</span> <span class="built_in">window</span>.orientation === <span class="string">'number'</span> &amp;&amp;</div><div class="line">        <span class="keyword">typeof</span> <span class="built_in">window</span>.onorientationchange === <span class="string">'object'</span>);</div><div class="line">    <span class="keyword">var</span> init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> htmlNode = <span class="built_in">document</span>.body.parentNode,</div><div class="line">            orientation;</div><div class="line"></div><div class="line">        <span class="keyword">var</span> updateOrientation = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (supportOrientation) &#123;</div><div class="line">                orientation = <span class="built_in">window</span>.orientation;</div><div class="line">                <span class="keyword">switch</span> (orientation) &#123;</div><div class="line">                    <span class="keyword">case</span> <span class="number">90</span>:</div><div class="line">                    <span class="keyword">case</span> <span class="number">-90</span>:</div><div class="line">                        orientation = <span class="string">'landscape'</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">default</span>:</div><div class="line">                        orientation = <span class="string">'portrait'</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                orientation = (<span class="built_in">window</span>.innerWidth &gt; <span class="built_in">window</span>.innerHeight) ? <span class="string">'landscape'</span> : <span class="string">'portrait'</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            htmlNode.setAttribute(<span class="string">'class'</span>, orientation);</div><div class="line">            <span class="comment">//</span></div><div class="line">            <span class="keyword">if</span> (orientation===<span class="string">'landscape'</span>) &#123;</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'横屏'</span>)</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(orientation===<span class="string">'portrait'</span>)&#123;</div><div class="line">                <span class="built_in">console</span>.log(<span class="string">'竖屏'</span>)</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="keyword">if</span> (supportOrientation) &#123;</div><div class="line">            <span class="built_in">window</span>.addEventListener(<span class="string">'orientationchange'</span>, updateOrientation, <span class="literal">false</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">//监听resize事件</span></div><div class="line">            <span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>, updateOrientation, <span class="literal">false</span>);</div><div class="line">        &#125;</div><div class="line">        updateOrientation();</div><div class="line">    &#125;;</div><div class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'DOMContentLoaded'</span>, init, <span class="literal">false</span>);</div><div class="line">&#125;)(<span class="built_in">window</span>);</div></pre></td></tr></table></figure>
<h4 id="设置缩放比"><a href="#设置缩放比" class="headerlink" title="设置缩放比"></a>设置缩放比</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//設置縮放 ipone6 2x </span></div><div class="line"><span class="keyword">const</span> dpr = <span class="built_in">window</span>.devicePixelRatio;</div><div class="line"><span class="keyword">var</span> meta = <span class="built_in">document</span>.createElement(<span class="string">'meta'</span>);</div><div class="line">meta.setAttribute(<span class="string">'name'</span>, <span class="string">'viewport'</span>);</div><div class="line">meta.setAttribute(<span class="string">'content'</span>, <span class="string">'width=device-width, initial-scale='</span> + <span class="number">1</span> / dpr + <span class="string">', maximum-scale='</span> + <span class="number">1</span> / dpr + <span class="string">', minimum-scale='</span> + <span class="number">1</span> / dpr + <span class="string">', user-scalable=no'</span>);</div><div class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(meta);</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/* ipone6 设计稿尺寸转rem(sass)*/</div><div class="line">@function px2rem($px)&#123;</div><div class="line">    $rem : 75px;</div><div class="line">    @return ($px/$rem) + rem;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/* ipone6 设计稿尺寸转rem(stylus)*/</div><div class="line"> px2rem(px)</div><div class="line">    $rem=75</div><div class="line">    (px/$rem)rem</div></pre></td></tr></table></figure>
<h4 id="js解析XML-字符串"><a href="#js解析XML-字符串" class="headerlink" title="js解析XML 字符串"></a>js解析XML 字符串</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> loadXML = <span class="function"><span class="keyword">function</span>(<span class="params">xmlString</span>)</span>&#123; <span class="comment">//构建xmldoc对象</span></div><div class="line">   </div><div class="line">     <span class="keyword">var</span> xmlDoc=<span class="literal">null</span>;</div><div class="line">      </div><div class="line">      <span class="keyword">if</span>(<span class="built_in">window</span>.DOMParser)  <span class="comment">//IE9+,FF,webkit</span></div><div class="line">      &#123;</div><div class="line">            <span class="keyword">try</span>&#123;</div><div class="line">                </div><div class="line">                domParser = <span class="keyword">new</span>  DOMParser();</div><div class="line">                xmlDoc = domParser.parseFromString(xmlString, <span class="string">'text/xml'</span>);</div><div class="line">            &#125;<span class="keyword">catch</span>(e)&#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">window</span>.DOMParser &amp;&amp; <span class="built_in">window</span>.ActiveXObject)</div><div class="line">        &#123;   <span class="comment">//window.DOMParser 判断是否是非ie浏览器</span></div><div class="line">            <span class="keyword">var</span> xmlDomVersions = [<span class="string">'MSXML2.DOMDocument'</span>,<span class="string">'Microsoft.XMLDOM'</span>];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;xmlDomVersions.length;i++)&#123;</div><div class="line">                <span class="keyword">try</span>&#123;</div><div class="line">                    xmlDoc = <span class="keyword">new</span> ActiveXObject(xmlDomVersions[i]);</div><div class="line">                    xmlDoc.async = <span class="literal">false</span>;</div><div class="line">                    xmlDoc.loadXML(xmlString); <span class="comment">//loadXML方法载入xml字符串</span></div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;<span class="keyword">catch</span>(e)&#123;</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> xmlDoc;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="//kenve.github.io/2017/01/20/javascript-utils/" data-id="cj2efeahu00015sdv81vj1ky6" class="article-share-link">分享</a><div class="tags"><a href="/tags/javascript/">javascript</a></div><div class="post-nav"><a href="/2017/01/21/mobile-responsive-solution/" class="pre">移动端自适应解决方案</a><a href="/2016/09/18/underscore-source-code-learning/" class="next">Undersocre 源码阅读</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="//kenve.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/随笔/" style="font-size: 15px;">随笔</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/html5/" style="font-size: 15px;">html5</a> <a href="/tags/react/" style="font-size: 15px;">react</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Kenve's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>